const action = require('./../../src/fragment/convertSchema.js');

const MGT_SCHEMA =
    '{"items":[{"path":"/content/dam/mas/docs/slice-cc-allapps","title":"CCD Suggested CC All Apps","description":"","id":"d8008cac-010f-4607-bacc-a7a327da1312","created":{"at":"2024-11-04T16:39:18.054Z","by":"sling-distribution-importer","fullName":"sling-distribution-importer"},"modified":{"at":"2024-11-04T17:05:13.004Z","by":"tuerkben@adobe.com","fullName":"tuerkben@adobe.com"},"status":"DRAFT","fields":[{"name":"variant","type":"text","multiple":false,"locked":false,"values":["ccd-suggested"]},{"name":"osi","type":"text","multiple":false,"locked":false,"values":[]},{"name":"size","type":"text","multiple":false,"locked":false,"values":[]},{"name":"mnemonicIcon","type":"text","multiple":true,"locked":false,"values":["https://www.adobe.com/content/dam/shared/images/product-icons/svg/photoshop.svg"]},{"name":"mnemonicAlt","type":"text","multiple":true,"locked":false,"values":[]},{"name":"mnemonicLink","type":"text","multiple":true,"locked":false,"values":[]},{"name":"badge","type":"long-text","multiple":false,"locked":false,"mimeType":"text/html","values":[]},{"name":"backgroundColor","type":"text","multiple":false,"locked":false,"values":[]},{"name":"backgroundImage","type":"text","multiple":false,"locked":false,"values":[]},{"name":"backgroundImageAltText","type":"text","multiple":false,"locked":false,"values":[]},{"name":"cardTitle","type":"text","multiple":false,"locked":false,"values":["Get the Photoshop plan"]},{"name":"cardTitleLink","type":"text","multiple":false,"locked":false,"values":[]},{"name":"subtitle","type":"text","multiple":false,"locked":false,"values":["INDIVIDUALS"]},{"name":"prices","type":"long-text","multiple":false,"locked":false,"mimeType":"text/html","values":["<span is=\\"inline-price\\" class=\\"secondary-link\\" data-template=\\"price\\" data-wcs-osi=\\"A1xn6EL4pK93bWjM8flffQpfEL-bnvtoQKQAvkx574M\\"></span>"]},{"name":"shortDescription","type":"long-text","multiple":false,"locked":false,"mimeType":"text/html","values":[]},{"name":"description","type":"long-text","multiple":false,"locked":false,"mimeType":"text/html","values":["<p>The full version of Photoshop plus Adobe Express Premium plan. </p>"]},{"name":"ctas","type":"long-text","multiple":false,"locked":false,"mimeType":"text/html","values":["<a is=\\"checkout-link\\" class=\\"secondary-link\\" href=\\"\\" data-wcs-osi=\\"A1xn6EL4pK93bWjM8flffQpfEL-bnvtoQKQAvkx574M\\">Buy now</a>"]},{"name":"parent","type":"content-fragment","multiple":false,"locked":false,"values":[]},{"name":"product","type":"content-reference","multiple":false,"locked":false,"values":[]},{"name":"stockOffer","type":"long-text","multiple":false,"locked":false,"mimeType":"text/html","values":[]},{"name":"secure","type":"boolean","multiple":false,"locked":false,"values":[false]},{"name":"tags","type":"tag","multiple":true,"locked":false,"values":[]},{"name":"locReady","type":"boolean","multiple":false,"locked":false,"values":[]}],"variations":[],"tags":[],"references":[],"model":{"id":"L2NvbmYvbWFzL3NldHRpbmdzL2RhbS9jZm0vbW9kZWxzL2NhcmQ","path":"/conf/mas/settings/dam/cfm/models/card","name":"Card","title":"Card","description":"universal m@s card model"},"validationStatus":[],"fieldTags":[],"etag":"f7ffe5d8b990a2212086bdfdf5a0613b"}]}';
const FREYJA_SCHEMA =
    '{"path":"/content/dam/mas/docs/slice-cc-allapps","name":"","title":"CCD Suggested CC All Apps","id":"d8008cac-010f-4607-bacc-a7a327da1312","description":"","model":{"id":"L2NvbmYvbWFzL3NldHRpbmdzL2RhbS9jZm0vbW9kZWxzL2NhcmQ"},"fields":{"variant":"ccd-suggested","mnemonicIcon":["https://www.adobe.com/content/dam/shared/images/product-icons/svg/photoshop.svg"],"mnemonicAlt":[],"mnemonicLink":[],"badge":{"mimeType":"text/html"},"cardTitle":"Get the Photoshop plan","subtitle":"INDIVIDUALS","prices":{"value":"<span is=\\"inline-price\\" class=\\"secondary-link\\" data-template=\\"price\\" data-wcs-osi=\\"A1xn6EL4pK93bWjM8flffQpfEL-bnvtoQKQAvkx574M\\"></span>","mimeType":"text/html"},"shortDescription":{"mimeType":"text/html"},"description":{"value":"<p>The full version of Photoshop plus Adobe Express Premium plan. </p>","mimeType":"text/html"},"ctas":{"value":"<a is=\\"checkout-link\\" class=\\"secondary-link\\" href=\\"\\" data-wcs-osi=\\"A1xn6EL4pK93bWjM8flffQpfEL-bnvtoQKQAvkx574M\\">Buy now</a>","mimeType":"text/html"},"stockOffer":{"mimeType":"text/html"},"secure":false,"tags":[]},"references":{},"referencesTree":[]}';

describe('convert typical cases', () => {
    test('should convert', async () => {
        const returnValue = await action.main({
            status: 200,
            body: JSON.parse(MGT_SCHEMA),
        });
        expect(returnValue).toEqual({
            status: 200,
            body: JSON.parse(FREYJA_SCHEMA),
        });
    });
});
